var iSlider=function(a){if(!a.dom)throw new Error("dom element can not be empty!");if(!a.data||!a.data.length)throw new Error("data must be an array and must have more than one element!");this._opts=a,this._setting(),this._renderHTML(),this._bindHandler()};iSlider.prototype._setting=function(){var a=this._opts;this.wrap=a.dom,this.data=a.data,this.type=a.type||"pic",this.isVertical=a.isVertical||!1,this.onslide=a.onslide,this.onslidestart=a.onslidestart,this.onslideend=a.onslideend,this.onslidechange=a.onslidechange,this.duration=a.duration||2e3,this.log=a.isDebug?function(a){console.log(a)}:function(){},this.axis=this.isVertical?"Y":"X",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=a.isVertical?this.height:this.width,this.sliderIndex=this.sliderIndex||0,this.data.length<2?(this.isLooping=!1,this.isAutoPlay=!1):(this.isLooping=a.isLooping||!1,this.isAutoplay=a.isAutoplay||!1),this.isAutoplay&&this.play(),this._setUpDamping(),this._animateFunc=a.animateType in this._animateFuncs?this._animateFuncs[a.animateType]:this._animateFuncs["default"],this._setPlayWhenFocus()},iSlider.prototype._setPlayWhenFocus=function(){var a=this;window.addEventListener("focus",function(){a.isAutoplay&&a.play()},!1),window.addEventListener("blur",function(){a.pause()},!1)},iSlider.prototype._animateFuncs={"default":function(a,b,c,d,e){a.style.webkitTransform="translateZ(0) translate"+b+"("+(e+c*(d-1))+"px)"},rotate:function(a,b,c,d,e){var f="X"==b?"Y":"X",g=Math.abs(e),h=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;this.isVertical&&(e=-e),this.wrap.style.webkitPerspective=4*c,a.style.zIndex=1==d?c-g:e>0?(1-d)*g:(d-1)*g,a.style.backgroundColor=h||"#333",a.style.position="absolute",a.style.webkitBackfaceVisibility="hidden",a.style.webkitTransformStyle="preserve-3d",a.style.webkitTransform="rotate"+f+"("+90*(e/c+d-1)+"deg) translateZ("+.888*c/2+"px) scale(0.888)"},flip:function(a,b,c,d,e){var f="X"==b?"Y":"X",g=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;this.isVertical&&(e=-e),this.wrap.style.webkitPerspective=4*c,a.style.visibility=e>0?d>1?"hidden":"visible":1>d?"hidden":"visible",a.style.backgroundColor=g||"#333",a.style.position="absolute",a.style.webkitBackfaceVisibility="hidden",a.style.webkitTransform="translateZ("+c/2+"px) rotate"+f+"("+180*(e/c+d-1)+"deg) scale(0.875)"},depth:function(a,b,c,d,e){var g=.15*(4-Math.abs(d-1));this.wrap.style.webkitPerspective=4*c,a.style.zIndex=1==d?100:e>0?1-d:d-1,a.style.webkitTransform="scale("+g+", "+g+") translateZ(0) translate"+b+"("+(e+1.3*c*(d-1))+"px)"},tear:function(a,b,c,d,e){var g=1-.2*Math.abs(d-1);this.wrap.style.webkitPerspective=4*c,a.style.zIndex=1==d?100:e>0?1-d:d-1,a.style.webkitTransform="scale("+g+", "+g+") translateZ(0) translate"+b+"("+(e+c*(d-1))+"px)"}},iSlider.prototype._setUpDamping=function(){var a=this.scale>>1,b=a>>1,c=b>>2;this._damping=function(d){var f,e=Math.abs(d);return f=a>e?e>>1:a+b>e?b+(e-a>>2):b+c+(e-a-b>>3),d>0?f:-f}},iSlider.prototype._renderItem=function(a){var b,c,d=this.data.length;return b=this.isLooping?0>a?this.data[d+a]:a>d-1?this.data[a-d]:this.data[a]:this.data[a]||{empty:!0},b.empty?"":("pic"===this.type?c=b.height/b.width<this.ratio?'<img height="'+this.height+'" src="'+b.content+'">':'<img width="'+this.width+'" src="'+b.content+'">':"dom"===this.type?c='<div style="height:'+b.height+";width:"+b.width+';">'+b.content+"</div>":"overspread"===this.type&&(c=this.ratio<1?'<div style="height: 100%; width:100%; background:url('+b.content+") center no-repeat; background-size:"+this.width+'px auto;"></div>':'<div style="height: 100%; width:100%; background:url('+b.content+") center no-repeat; background-size: auto "+this.height+'px;"></div>'),c)},iSlider.prototype._renderHTML=function(){var a,b,c;for(this.outer?(this.outer.innerHTML="",a=this.outer):a=document.createElement("ul"),a.style.width=this.width+"px",a.style.height=this.height+"px",this.els=[],b=0;3>b;b++)c=document.createElement("li"),c.style.width=this.width+"px",c.style.height=this.height+"px",this._animateFunc(c,this.axis,this.scale,b,0),this.els.push(c),a.appendChild(c),c.innerHTML=!this.isVertical||"rotate"!=this._opts.animateType&&"flip"!=this._opts.animateType?this._renderItem(b-1+this.sliderIndex):this._renderItem(1-b+this.sliderIndex);this.outer||(this.outer=a,this.wrap.appendChild(a))},iSlider.prototype._slide=function(a){var e,f,b=this.data,c=this.els,d=this.sliderIndex+a;for(b[d]?this.sliderIndex=d:this.isLooping?this.sliderIndex=a>0?0:b.length-1:a=0,this.log("pic idx:"+this.sliderIndex),!this.isVertical||"rotate"!=this._opts.animateType&&"flip"!=this._opts.animateType?a>0?(e=c.shift(),c.push(e)):0>a&&(e=c.pop(),c.unshift(e)):a>0?(e=c.pop(),c.unshift(e)):0>a&&(e=c.shift(),c.push(e)),0!==a&&(e.innerHTML=this._renderItem(d+a),e.style.webkitTransition="none",e.style.visibility="hidden",setTimeout(function(){e.style.visibility="visible"},200),this.onslidechange&&this.onslidechange(this.sliderIndex)),f=0;3>f;f++)c[f]!==e&&(c[f].style.webkitTransition="all .3s ease"),this._animateFunc(c[f],this.axis,this.scale,f,0);this.isAutoplay&&(this.sliderIndex!==b.length-1||this.isLooping||this.pause())},iSlider.prototype._bindHandler=function(){var c,e,f,g,h,a=this;a.scaleW,c=a.outer,a.data.length,e=function(b){a.pause(),a.onslidestart&&a.onslidestart(),a.log("Event: beforeslide"),a.startTime=(new Date).getTime(),a.startX=b.targetTouches[0].pageX,a.startY=b.targetTouches[0].pageY;for(var c=b.target;"LI"!=c.nodeName&&"BODY"!=c.nodeName;)c=c.parentNode;a.target=c},f=function(b){var c,d,e,f;for(b.preventDefault(),a.onslide&&a.onslide(),a.log("Event: onslide"),c=a.axis,d=b.targetTouches[0]["page"+c]-a["start"+c],a.isLooping||(d>0&&0===a.sliderIndex||0>d&&a.sliderIndex===a.data.length-1)&&(d=a._damping(d)),e=0;3>e;e++)f=a.els[e],f.style.webkitTransition="all 0s",a._animateFunc(f,c,a.scale,e,d);a.offset=d},g=function(b){var c,d,e;b.preventDefault(),c=a.scale/2,d=a.offset,e=(new Date).getTime(),c=e-a.startTime>300?c:14,d>=c?a._slide(-1):-c>d?a._slide(1):a._slide(0),a.isAutoplay&&a.play(),a.offset=0,a.onslideend&&a.onslideend(),a.log("Event: afterslide")},h=function(){setTimeout(function(){a.reset(),a.log("Event: orientationchange")},100)},c.addEventListener("touchstart",e),c.addEventListener("touchmove",f),c.addEventListener("touchend",g),window.addEventListener("orientationchange",h)},iSlider.prototype.reset=function(){this.pause(),this._setting(),this._renderHTML(),this.isAutoplay&&this.play()},iSlider.prototype.play=function(){var a=this,b=this.duration;clearInterval(this.autoPlayTimer),this.autoPlayTimer=setInterval(function(){a._slide(1)},b)},iSlider.prototype.pause=function(){clearInterval(this.autoPlayTimer)},iSlider.prototype.extend=function(a){var b=iSlider.prototype;Object.keys(a).forEach(function(c){Object.defineProperty(b,c,Object.getOwnPropertyDescriptor(a,c))})},iSlider.prototype.extend({bindMouse:function(){var c,e,f,g,h,a=this;a.scaleW,c=a.outer,a.data.length,e=!1,f=function(b){e=!0,a.pause(),a.onslidestart&&a.onslidestart(),a.startTime=(new Date).getTime(),a.startX=b.clientX,a.startY=b.clientY;for(var c=b.target;"LI"!=c.nodeName&&"BODY"!=c.nodeName;)c=c.parentNode;a.target=c},g=function(b){var c,d,f,g;if(e){for(b.preventDefault(),a.onslide&&a.onslide(),c=a.axis,d=b["client"+c]-a["start"+c],a.isLooping||(d>0&&0===a.sliderIndex||0>d&&a.sliderIndex===a.data.length-1)&&(d=a._damping(d)),f=0;3>f;f++)g=a.els[f],g.style.webkitTransition="all 0s",a._animateFunc(g,c,a.scale,f,d);a.offset=d}},h=function(b){var c,d,f;b.preventDefault(),e=!1,c=a.scale/2,d=a.offset,f=(new Date).getTime(),c=f-a.startTime>300?c:14,d>=c?a._slide(-1):-c>d?a._slide(1):a._slide(0),a.isAutoplay&&a.play(),a.offset=0,a.onslideend&&a.onslideend(),a.log("Event: afterslide")},c.addEventListener("mousedown",f),c.addEventListener("mousemove",g),c.addEventListener("mouseup",h)}});